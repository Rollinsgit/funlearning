<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juliette's Learning Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Comic Sans MS', 'Trebuchet MS', 'Arial', sans-serif; 
            background: linear-gradient(135deg, #FFB6D9, #FFD700, #87CEEB, #98FF98);
            padding: 15px; 
            color: #333; 
            min-height: 100vh;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { 
            background: linear-gradient(135deg, #FF1493, #FF69B4);
            padding: 25px; 
            border-radius: 25px; 
            margin-bottom: 20px; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            text-align: center;
            border: 5px solid #FFD700;
        }
        .header h1 { 
            color: white; 
            font-size: 2.5rem; 
            text-shadow: 3px 3px 0px rgba(0,0,0,0.3);
        }
        .header p { 
            color: white;
            font-size: 1.2rem;
            margin-top: 10px;
        }
        .tabs { 
            display: flex; 
            gap: 10px; 
            margin-bottom: 20px; 
            flex-wrap: wrap;
        }
        .tab-btn { 
            background: linear-gradient(135deg, #00D4FF, #0099FF);
            padding: 15px 20px; 
            border-radius: 20px; 
            cursor: pointer; 
            font-weight: 700; 
            color: white; 
            border: 4px solid white;
            font-size: 1rem;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .tab-btn:hover { transform: scale(1.1); }
        .tab-btn.active { 
            background: linear-gradient(135deg, #FF1493, #FF69B4);
            border-color: #FFD700;
        }
        .content { 
            background: white; 
            padding: 25px; 
            border-radius: 20px; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.15); 
            display: none;
            border: 5px solid #FFD700;
        }
        .content.active { display: block; }
        .content h2 { 
            font-size: 1.8rem; 
            margin-bottom: 20px; 
            color: #FF1493;
        }
        .section { 
            background: #FFE4E1;
            padding: 15px; 
            border-radius: 15px; 
            margin-bottom: 15px; 
            border: 3px dashed #FF69B4;
        }
        .section h3 { 
            color: #FF1493; 
            margin-bottom: 15px; 
            font-size: 1.3rem;
        }
        .activity-card {
            background: white;
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 3px solid #FFD700;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s;
            min-height: 50px;
            touch-action: manipulation;
        }
        .activity-card.checked {
            background: linear-gradient(135deg, #98FF98, #00FF00);
            border-color: #00AA00;
        }
        input[type="checkbox"] {
            width: 40px;
            height: 40px;
            cursor: pointer;
            accent-color: #00AA00;
            flex-shrink: 0;
            pointer-events: auto;
        }
        .activity-label {
            flex: 1;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 500;
            pointer-events: none;
        }
        .btn { 
            background: linear-gradient(135deg, #00D4FF, #0099FF);
            color: white; padding: 12px 20px; border: 3px solid white;
            border-radius: 15px; cursor: pointer; font-weight: 700;
        }
        .btn-danger { background: linear-gradient(135deg, #FF6B6B, #FF1493); }
        input[type="text"] { padding: 12px; border-radius: 10px; border: 3px solid #FFD700; width: 100%; margin: 10px 0; }
        .book-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; }
        .book-btn { background: #FFB6D9; padding: 10px; border-radius: 15px; border: 4px solid #FF1493; text-align: center; cursor: pointer; color: white; }
        .book-btn.selected { background: #FFD700; color: #FF1493; }
        .badge-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 12px; }
        .badge-btn { background: #FFD700; padding: 20px; border-radius: 15px; border: 4px solid #FF1493; font-size: 2rem; cursor: pointer; }
        .badge-btn.earned { background: #98FF98; border-color: #00AA00; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ‰ Juliette's Learning Adventure! ğŸ‰</h1>
            <p>Learn, Play, and Earn Rewards!</p>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('activities')">ğŸ“š Learning Activities</button>
            <button class="tab-btn" onclick="showTab('books')">ğŸ“– Pick a Book</button>
            <button class="tab-btn" onclick="showTab('rewards')">ğŸ† Rewards</button>
            <button class="tab-btn" onclick="showTab('manage')">âš™ï¸ Add New</button>
        </div>
        
        <div id="activities" class="content active">
            <h2>ğŸ“š My Learning Activities</h2>
            <button class="btn btn-danger" onclick="resetDay()">ğŸ”„ Reset Today</button>
            <div class="section">
                <h3>Today's Learning</h3>
                <div class="activity-card" id="a1" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c1" onclick="event.stopPropagation()" onchange="updateActivityCard(1)">
                    <label class="activity-label" for="c1">ğŸ“± Reading.com</label>
                </div>
                <div class="activity-card" id="a2" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c2" onclick="event.stopPropagation()" onchange="updateActivityCard(2)">
                    <label class="activity-label" for="c2">ğŸŒŠ SplashLearn</label>
                </div>
                <div class="activity-card" id="a3" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c3" onclick="event.stopPropagation()" onchange="updateActivityCard(3)">
                    <label class="activity-label" for="c3">ğŸŒ Lingokids</label>
                </div>
                <div class="activity-card" id="a4" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c4" onclick="event.stopPropagation()" onchange="updateActivityCard(4)">
                    <label class="activity-label" for="c4">ğŸ“ Khan Academy Kids</label>
                </div>
                <div class="activity-card" id="a5" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c5" onclick="event.stopPropagation()" onchange="updateActivityCard(5)">
                    <label class="activity-label" for="c5">ğŸ“š Bob Books</label>
                </div>
                <div class="activity-card" id="a6" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c6" onclick="event.stopPropagation()" onchange="updateActivityCard(6)">
                    <label class="activity-label" for="c6">ğŸ“– Readers & Books</label>
                </div>
                <div class="activity-card" id="a7" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c7" onclick="event.stopPropagation()" onchange="updateActivityCard(7)">
                    <label class="activity-label" for="c7">âœï¸ Grooved Books</label>
                </div>
                <div class="activity-card" id="a8" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c8" onclick="event.stopPropagation()" onchange="updateActivityCard(8)">
                    <label class="activity-label" for="c8">ğŸ¨ Arts & Crafts</label>
                </div>
                <div class="activity-card" id="a9" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c9" onclick="event.stopPropagation()" onchange="updateActivityCard(9)">
                    <label class="activity-label" for="c9">ğŸ”¬ Science Projects</label>
                </div>
            </div>
        </div>
        
        <div id="books" class="content">
            <h2>ğŸ“– Pick a Book!</h2>
            <div class="book-grid" id="bookGrid"></div>
            <div id="currentBook" style="margin-top:20px; font-weight:bold;">Pick a book!</div>
        </div>
        
        <div id="rewards" class="content">
            <h2>ğŸ† Rewards</h2>
            <div class="badge-grid" id="badgeGrid"></div>
            <h3>Badges Earned ğŸ‰</h3>
            <div id="earnedDisplay" style="display:flex; gap:10px; margin-top:10px;"></div>
        </div>
        
        <div id="manage" class="content">
            <h2>âš™ï¸ Manage</h2>
            <div class="section">
                <h3>Add Book</h3>
                <input type="text" id="bookTitle" placeholder="Book Name">
                <input type="file" id="bookPhoto" accept="image/*">
                <button class="btn" onclick="addBook()">Add</button>
                <div id="bookList"></div>
            </div>
        </div>
    </div>

    <script>
        // --- QUIET SOUNDS ---
        const clickSound = new Audio('https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3');
        const chimeSound = new Audio('https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3');

        // Set volume to very low
        clickSound.volume = 0.05;
        chimeSound.volume = 0.05;

        function playSound(type) {
            try {
                let s = (type === 'click') ? clickSound : chimeSound;
                s.currentTime = 0;
                s.play().catch(e => {}); // Catch browser block
            } catch (e) {}
        }

        const FIREBASE_URL = 'https://funlearning-f53a4-default-rtdb.firebaseio.com';
        const DEVICE_ID = 'juliette_shared_data';

        let books = [["ğŸ“š", "My First Book", null, "A fun start!"]];
        let badges = [["ğŸŒŸ", "Star Learner"]];
        let earnedBadges = [];
        let selectedBook = null;

        function saveToFirebase(data) {
            fetch(FIREBASE_URL + '/' + DEVICE_ID + '/data.json', {
                method: 'PUT',
                body: JSON.stringify(data)
            }).catch(e => {});
        }

        function loadFromFirebase() {
            fetch(FIREBASE_URL + '/' + DEVICE_ID + '/data.json')
                .then(r => r.json())
                .then(data => {
                    if (data) {
                        books = data.books || books;
                        badges = data.badges || badges;
                        earnedBadges = data.earnedBadges || [];
                        selectedBook = data.selectedBook !== undefined ? data.selectedBook : null;
                        if (data.checkboxStates) {
                            Object.keys(data.checkboxStates).forEach(id => {
                                const cb = document.getElementById(id);
                                if (cb) {
                                    cb.checked = data.checkboxStates[id];
                                    updateActivityCard(parseInt(id.substring(1)), true);
                                }
                            });
                        }
                        displayBooks();
                        displayRewards();
                    }
                });
        }

        function showTab(tab) {
            document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tab).classList.add('active');
            event.target.classList.add('active');
            if (tab === 'manage') displayManage();
        }

        function toggleActivityCard(card, event) {
            if (event && event.target.tagName === 'INPUT') return;
            const cb = card.querySelector('input[type="checkbox"]');
            cb.checked = !cb.checked;
            updateActivityCard(parseInt(card.id.substring(1)));
        }

        function updateActivityCard(num, silent = false) {
            const card = document.getElementById('a' + num);
            const cb = document.getElementById('c' + num);
            if (cb.checked) {
                card.classList.add('checked');
                if (!silent) playSound('click');
            } else {
                card.classList.remove('checked');
            }
            save();
        }

        function toggleBadge(idx) {
            if (earnedBadges.includes(idx)) {
                earnedBadges = earnedBadges.filter(i => i !== idx);
            } else {
                earnedBadges.push(idx);
                playSound('chime');
            }
            displayRewards();
            save();
        }

        function displayBooks() {
            let html = '';
            books.forEach((b, i) => {
                html += `<div class="book-btn ${selectedBook === i ? 'selected' : ''}" onclick="selectBook(${i})">
                    <div style="font-size:2rem">${b[0]}</div><div>${b[1]}</div></div>`;
            });
            document.getElementById('bookGrid').innerHTML = html;
        }

        function selectBook(idx) {
            selectedBook = (selectedBook === idx) ? null : idx;
            displayBooks();
            save();
        }

        function displayRewards() {
            let html = '';
            badges.forEach((b, i) => {
                html += `<div class="badge-btn ${earnedBadges.includes(i) ? 'earned' : ''}" onclick="toggleBadge(${i})">${b[0]}</div>`;
            });
            document.getElementById('badgeGrid').innerHTML = html;
            
            let earnedHtml = '';
            earnedBadges.forEach(i => earnedHtml += `<div style="font-size:2rem">${badges[i][0]}</div>`);
            document.getElementById('earnedDisplay').innerHTML = earnedHtml;
        }

        function resetDay() {
            document.querySelectorAll('input[type="checkbox"]').forEach(c => c.checked = false);
            document.querySelectorAll('.activity-card').forEach(c => c.classList.remove('checked'));
            save();
        }

        function save() {
            const checkboxStates = {};
            document.querySelectorAll('input[type="checkbox"]').forEach(c => checkboxStates[c.id] = c.checked);
            saveToFirebase({ books, badges, earnedBadges, selectedBook, checkboxStates });
        }

        document.addEventListener('DOMContentLoaded', loadFromFirebase);
    </script>
</body>
</html>
