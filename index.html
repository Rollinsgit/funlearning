<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juliette's Learning Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Comic Sans MS', 'Trebuchet MS', 'Arial', sans-serif; 
            background: linear-gradient(135deg, #FFB6D9, #FFD700, #87CEEB, #98FF98);
            padding: 15px; 
            color: #333; 
            min-height: 100vh;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { 
            background: linear-gradient(135deg, #FF1493, #FF69B4);
            padding: 25px; 
            border-radius: 25px; 
            margin-bottom: 20px; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            text-align: center;
            border: 5px solid #FFD700;
        }
        .header h1 { 
            color: white; 
            font-size: 2.5rem; 
            text-shadow: 3px 3px 0px rgba(0,0,0,0.3);
        }
        .header p { 
            color: white;
            font-size: 1.2rem;
            margin-top: 10px;
        }
        .tabs { 
            display: flex; 
            gap: 10px; 
            margin-bottom: 20px; 
            flex-wrap: wrap;
        }
        .tab-btn { 
            background: linear-gradient(135deg, #00D4FF, #0099FF);
            padding: 15px 20px; 
            border-radius: 20px; 
            cursor: pointer; 
            font-weight: 700; 
            color: white; 
            border: 4px solid white;
            font-size: 1rem;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .tab-btn:hover { transform: scale(1.1); }
        .tab-btn.active { 
            background: linear-gradient(135deg, #FF1493, #FF69B4);
            border-color: #FFD700;
        }
        .content { 
            background: white; 
            padding: 25px; 
            border-radius: 20px; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.15); 
            display: none;
            border: 5px solid #FFD700;
        }
        .content.active { display: block; }
        .content h2 { 
            font-size: 1.8rem; 
            margin-bottom: 20px; 
            color: #FF1493;
        }
        .section { 
            background: #FFE4E1;
            padding: 15px; 
            border-radius: 15px; 
            margin-bottom: 15px; 
            border: 3px dashed #FF69B4;
        }
        .section h3 { 
            color: #FF1493; 
            margin-bottom: 15px; 
            font-size: 1.3rem;
        }
        .activity-card {
            background: white;
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 3px solid #FFD700;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s;
            min-height: 50px;
            touch-action: manipulation;
        }
        .activity-card:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }
        .activity-card.checked {
            background: linear-gradient(135deg, #98FF98, #00FF00);
            border-color: #00AA00;
            box-shadow: 0 6px 20px rgba(152, 255, 152, 0.4);
        }
        input[type="checkbox"] {
            width: 40px;
            height: 40px;
            cursor: pointer;
            accent-color: #00AA00;
            flex-shrink: 0;
            pointer-events: auto;
        }
        .activity-label {
            flex: 1;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 500;
            pointer-events: none;
        }
        .btn { 
            background: linear-gradient(135deg, #00D4FF, #0099FF);
            color: white; 
            padding: 12px 20px; 
            border: 3px solid white;
            border-radius: 15px; 
            cursor: pointer; 
            font-weight: 700; 
            font-size: 1rem;
            transition: all 0.3s;
            margin: 10px 10px 10px 0;
        }
        .btn:hover { transform: scale(1.05); }
        .btn-danger { background: linear-gradient(135deg, #FF6B6B, #FF1493); }
        input[type="text"] { 
            padding: 12px; 
            font-size: 1.1rem; 
            border-radius: 10px; 
            border: 3px solid #FFD700; 
            margin: 10px 0; 
            width: 100%; 
            font-family: 'Comic Sans MS', 'Trebuchet MS', 'Arial', sans-serif;
        }
        .book-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .book-btn {
            background: linear-gradient(135deg, #FF69B4, #FFB6D9);
            padding: 10px;
            border-radius: 12px 12px 20px 20px;
            border: 4px solid #FF1493;
            text-align: center;
            cursor: pointer;
            color: white;
            font-weight: bold;
            width: 140px;
            height: 160px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            transition: all 0.3s;
            box-shadow: 0 6px 20px rgba(255, 20, 147, 0.3);
            position: relative;
            overflow: hidden;
        }
        .book-emoji {
            font-size: 2.5rem;
            margin: 8px 0;
        }
        .book-btn:hover { transform: scale(1.1) rotate(-3deg); }
        .book-btn.selected {
            background: linear-gradient(135deg, #FFD700, #FFF000);
            border-color: #FF1493;
            color: #FF1493;
        }
        .book-title { 
            font-size: 0.8rem; 
            font-weight: bold;
            margin-top: auto;
        }
        .badge-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 12px;
            margin: 15px 0;
        }
        .badge-btn {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            padding: 20px;
            border-radius: 15px;
            border: 4px solid #FF1493;
            font-size: 2.2rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .badge-btn:hover { transform: scale(1.1) rotate(5deg); }
        .badge-btn.earned {
            background: linear-gradient(135deg, #98FF98, #00FF00);
            border-color: #00AA00;
        }
        .badge-label { font-size: 0.75rem; margin-top: 5px; font-weight: bold; }
        .earned-display {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
            gap: 10px;
        }
        .earned-badge {
            background: linear-gradient(135deg, #98FF98, #00FF00);
            padding: 12px;
            border-radius: 12px;
            border: 3px solid #00AA00;
            font-size: 1.8rem;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéâ Juliette's Learning Adventure! üéâ</h1>
            <p>Learn, Play, and Earn Rewards!</p>
            <div style="font-size: 2rem; margin-top: 10px;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('activities')">üìö Learning Activities</button>
            <button class="tab-btn" onclick="showTab('books')">üìñ Pick a Book</button>
            <button class="tab-btn" onclick="showTab('rewards')">üèÜ Rewards</button>
            <button class="tab-btn" onclick="showTab('manage')">‚öôÔ∏è Add New</button>
        </div>
        
        <div id="activities" class="content active">
            <h2>üìö My Learning Activities</h2>
            <button class="btn btn-danger" onclick="resetDay()">üîÑ Reset Today</button>
            <div class="section">
                <h3>Today's Learning</h3>
                <div class="activity-card" id="a1" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c1" onclick="event.stopPropagation()" onchange="updateActivityCard(1)">
                    <label class="activity-label" for="c1">üì± Reading.com</label>
                </div>
                <div class="activity-card" id="a2" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c2" onclick="event.stopPropagation()" onchange="updateActivityCard(2)">
                    <label class="activity-label" for="c2">üåä SplashLearn</label>
                </div>
                <div class="activity-card" id="a3" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c3" onclick="event.stopPropagation()" onchange="updateActivityCard(3)">
                    <label class="activity-label" for="c3">üåç Lingokids</label>
                </div>
                <div class="activity-card" id="a4" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c4" onclick="event.stopPropagation()" onchange="updateActivityCard(4)">
                    <label class="activity-label" for="c4">üéì Khan Academy Kids</label>
                </div>
                <div class="activity-card" id="a5" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c5" onclick="event.stopPropagation()" onchange="updateActivityCard(5)">
                    <label class="activity-label" for="c5">üìö Bob Books</label>
                </div>
                <div class="activity-card" id="a6" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c6" onclick="event.stopPropagation()" onchange="updateActivityCard(6)">
                    <label class="activity-label" for="c6">üìñ Readers & Books</label>
                </div>
                <div class="activity-card" id="a7" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c7" onclick="event.stopPropagation()" onchange="updateActivityCard(7)">
                    <label class="activity-label" for="c7">‚úèÔ∏è Grooved Books</label>
                </div>
                <div class="activity-card" id="a8" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c8" onclick="event.stopPropagation()" onchange="updateActivityCard(8)">
                    <label class="activity-label" for="c8">üé® Arts & Crafts</label>
                </div>
                <div class="activity-card" id="a9" onclick="toggleActivityCard(this, event)">
                    <input type="checkbox" id="c9" onclick="event.stopPropagation()" onchange="updateActivityCard(9)">
                    <label class="activity-label" for="c9">üî¨ Science Projects</label>
                </div>
            </div>
        </div>
        
        <div id="books" class="content">
            <h2>üìñ Pick a Book to Read!</h2>
            <div class="section">
                <h3>Click a book to choose it!</h3>
                <div class="book-grid" id="bookGrid"></div>
            </div>
            <div class="section">
                <h3>Current Choice:</h3>
                <div id="currentBook" style="font-size: 1.2rem; color: #FF1493; font-weight: bold; padding: 15px; background: #FFF0F5; border-radius: 10px; border: 3px solid #FFD700;">Pick a book!</div>
            </div>
        </div>
        
        <div id="rewards" class="content">
            <h2>üèÜ My Rewards & Badges</h2>
            <p style="color: #FF1493; font-weight: bold; margin-bottom: 15px;">Click badges to award them!</p>
            <div class="section">
                <h3>Available Badges</h3>
                <div class="badge-grid" id="badgeGrid"></div>
            </div>
            <div class="section">
                <h3>Badges Earned üéâ</h3>
                <div class="earned-display" id="earnedDisplay"></div>
            </div>
        </div>
        
        <div id="manage" class="content">
            <h2>‚ûï Add New Items</h2>
            <div class="section">
                <h3>Add a Book</h3>
                <input type="text" id="bookTitle" placeholder="Book Name">
                <input type="file" id="bookPhoto" accept="image/*">
                <button class="btn" onclick="addBook()">Add Book</button>
                <div id="bookList"></div>
            </div>
            <div class="section">
                <h3>Add a Badge</h3>
                <input type="text" id="badgeEmoji" placeholder="Emoji (e.g., üåü)" maxlength="5">
                <input type="text" id="badgeTitle" placeholder="Badge Name">
                <button class="btn" onclick="addBadge()">Add Badge</button>
                <div id="badgeList"></div>
            </div>
        </div>
    </div>

    <script>
        // --- UPDATED SOUNDS & VOLUME ---
        const activityPop = new Audio('https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3');
        const rewardChime = new Audio('https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3');

        // Set volume to half (0.5)
        activityPop.volume = 0.5;
        rewardChime.volume = 0.5;

        function playSound(type) {
            try {
                if (type === 'pop') {
                    activityPop.currentTime = 0;
                    activityPop.play();
                } else if (type === 'chime') {
                    rewardChime.currentTime = 0;
                    rewardChime.play();
                }
            } catch (e) { console.log('Audio error'); }
        }

        const FIREBASE_URL = 'https://funlearning-f53a4-default-rtdb.firebaseio.com';
        const DEVICE_ID = 'juliette_shared_data';

        let books = [["üìö", "My First Book", null, "A fun start!"]];
        let badges = [["üåü", "Star Learner"]];
        let earnedBadges = [];
        let selectedBook = null;

        function saveToFirebase(data) {
            fetch(FIREBASE_URL + '/' + DEVICE_ID + '/data.json', {
                method: 'PUT',
                body: JSON.stringify(data)
            }).catch(error => console.log('Firebase save error:', error));
        }

        function loadFromFirebase() {
            fetch(FIREBASE_URL + '/' + DEVICE_ID + '/data.json')
                .then(response => response.json())
                .then(data => {
                    if (data) {
                        books = data.books || books;
                        badges = data.badges || badges;
                        earnedBadges = data.earnedBadges || [];
                        selectedBook = data.selectedBook !== undefined ? data.selectedBook : null;
                        
                        if (data.checkboxStates) {
                            Object.keys(data.checkboxStates).forEach(checkboxId => {
                                const checkbox = document.getElementById(checkboxId);
                                if (checkbox) {
                                    checkbox.checked = data.checkboxStates[checkboxId];
                                    updateActivityCard(parseInt(checkboxId.substring(1)), true);
                                }
                            });
                        }
                        displayBooks();
                        displayRewards();
                    }
                });
        }

        function showTab(tab) {
            document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tab).classList.add('active');
            event.target.classList.add('active');
            if (tab === 'manage') displayManage();
            if (tab === 'books') displayBooks();
            if (tab === 'rewards') displayRewards();
        }

        function displayBooks() {
            let html = '';
            books.forEach((b, i) => {
                html += '<div class="book-btn ' + (selectedBook === i ? 'selected' : '') + '" onclick="selectBook(' + i + ')">';
                if (b[2]) {
                    html += '<img src="' + b[2] + '" style="width: 90px; height: 90px; object-fit: cover; border-radius: 8px; margin: 5px 0; border: 3px solid rgba(255,255,255,0.7);">';
                } else { html += '<div class="book-emoji">' + b[0] + '</div>'; }
                html += '<div class="book-title">' + b[1] + '</div></div>';
            });
            document.getElementById('bookGrid').innerHTML = html;
            updateBookDisplay();
        }

        function selectBook(idx) {
            selectedBook = selectedBook === idx ? null : idx;
            displayBooks();
            save();
        }

        function updateBookDisplay() {
            if (selectedBook !== null) {
                let display = '<div style="font-size: 1.5rem; margin-bottom: 10px;">' + books[selectedBook][0] + '</div>';
                display += '<div style="font-size: 1.3rem; color: #FF1493; font-weight: bold; margin-bottom: 10px;">' + books[selectedBook][1] + '</div>';
                document.getElementById('currentBook').innerHTML = display;
            } else {
                document.getElementById('currentBook').innerHTML = 'Pick a book!';
            }
        }

        function displayRewards() {
            let html = '';
            badges.forEach((b, i) => {
                html += '<div class="badge-btn ' + (earnedBadges.includes(i) ? 'earned' : '') + '" onclick="toggleBadge(' + i + ')"><div>' + b[0] + '</div><div class="badge-label">' + b[1] + '</div></div>';
            });
            document.getElementById('badgeGrid').innerHTML = html;
            
            let earned = '';
            earnedBadges.forEach(i => {
                earned += '<div class="earned-badge">' + badges[i][0] + '</div>';
            });
            document.getElementById('earnedDisplay').innerHTML = earned || 'Earn some badges!';
        }

        function toggleBadge(idx) {
            if (earnedBadges.includes(idx)) {
                earnedBadges = earnedBadges.filter(i => i !== idx);
            } else {
                earnedBadges.push(idx);
                playSound('chime');
            }
            displayRewards();
            save();
        }

        function addBook() {
            const title = document.getElementById('bookTitle').value.trim();
            const photoFile = document.getElementById('bookPhoto').files[0];
            if (!title) return;
            if (photoFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    books.push(["üìö", title, e.target.result, "A great book!"]);
                    displayBooks(); displayManage(); save();
                };
                reader.readAsDataURL(photoFile);
            } else {
                books.push(["üìö", title, null, "A great book!"]);
                displayBooks(); displayManage(); save();
            }
        }

        function addBadge() {
            const emoji = document.getElementById('badgeEmoji').value.trim();
            const title = document.getElementById('badgeTitle').value.trim();
            if (!emoji || !title) return;
            badges.push([emoji, title]);
            displayRewards(); displayManage(); save();
        }

        function displayManage() {
            let html = '';
            books.forEach((b, i) => {
                html += '<div style="background: #E1F5FF; padding: 10px; margin: 5px 0; border-radius: 8px; display: flex; justify-content: space-between;">' + b[1] + '<button class="btn" onclick="books.splice(' + i + ',1); displayManage(); save();">X</button></div>';
            });
            document.getElementById('bookList').innerHTML = html;
        }

        function resetDay() {
            document.querySelectorAll('input[type="checkbox"]').forEach(c => c.checked = false);
            document.querySelectorAll('.activity-card').forEach(card => card.classList.remove('checked'));
            save();
        }

        function save() {
            const checkboxStates = {};
            document.querySelectorAll('input[type="checkbox"]').forEach(c => {
                checkboxStates[c.id] = c.checked;
            });
            saveToFirebase({ books, badges, earnedBadges, selectedBook, checkboxStates });
        }

        function toggleActivityCard(card, event) {
            if (event && event.target.tagName === 'INPUT') return;
            const checkbox = card.querySelector('input[type="checkbox"]');
            checkbox.checked = !checkbox.checked;
            updateActivityCard(parseInt(card.id.substring(1)));
        }

        function updateActivityCard(num, silent = false) {
            const card = document.getElementById('a' + num);
            const checkbox = document.getElementById('c' + num);
            if (checkbox.checked) {
                card.classList.add('checked');
                if (!silent) playSound('pop'); 
            } else {
                card.classList.remove('checked');
            }
            save();
        }

        document.addEventListener('DOMContentLoaded', loadFromFirebase);
    </script>
</body>
</html>
